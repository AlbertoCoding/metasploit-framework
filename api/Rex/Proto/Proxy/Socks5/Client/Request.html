<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Rex::Proto::Proxy::Socks5::Client::Request
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="../../../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Rex::Proto::Proxy::Socks5::Client::Request";
  relpath = '../../../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../../../_index.html">Index (R)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../Proto.html" title="Rex::Proto (module)">Proto</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Proxy.html" title="Rex::Proto::Proxy (module)">Proxy</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Socks5.html" title="Rex::Proto::Proxy::Socks5 (class)">Socks5</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Client.html" title="Rex::Proto::Proxy::Socks5::Client (class)">Client</a></span></span>
     &raquo; 
    <span class="title">Request</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Rex::Proto::Proxy::Socks5::Client::Request
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Rex::Proto::Proxy::Socks5::Client::Request</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rex/proto/proxy/socks5.rb</dd>
  </dl>
  
</div>





  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#atyp-instance_method" title="#atyp (instance method)">#<strong>atyp</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute atyp.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#command-instance_method" title="#command (instance method)">#<strong>command</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute command.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#dest_ip-instance_method" title="#dest_ip (instance method)">#<strong>dest_ip</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute dest_ip.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#dest_port-instance_method" title="#dest_port (instance method)">#<strong>dest_port</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute dest_port.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#hostname-instance_method" title="#hostname (instance method)">#<strong>hostname</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute hostname.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#version-instance_method" title="#version (instance method)">#<strong>version</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute version.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(sock)  &#x21d2; Request </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Request.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_bind%3F-instance_method" title="#is_bind? (instance method)">#<strong>is_bind?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_connect%3F-instance_method" title="#is_connect? (instance method)">#<strong>is_connect?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parseIncomingConnectionRequest-instance_method" title="#parseIncomingConnectionRequest (instance method)">#<strong>parseIncomingConnectionRequest</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parseIncomingCredentials-instance_method" title="#parseIncomingCredentials (instance method)">#<strong>parseIncomingCredentials</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parseIncomingSession-instance_method" title="#parseIncomingSession (instance method)">#<strong>parseIncomingSession</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The first packet sent by the client is a session request
<code>----</code>———-<code>----------</code> |VER | NMETHODS | METHODS  |
<code>----</code>———-<code>----------</code> | 1  |    1     | 1 to 255 |  
METHOD (x00) = NO AUTHENTICATION REQUIRED
<code>----</code>———-<code>----------</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#requireAuthentication-instance_method" title="#requireAuthentication (instance method)">#<strong>requireAuthentication</strong>(username, password)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#resolve-instance_method" title="#resolve (instance method)">#<strong>resolve</strong>(hostname)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Resolve the given hostname into a dotted IP address.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(sock)  &#x21d2; <tt><span class='object_link'><a href="" title="Rex::Proto::Proxy::Socks5::Client::Request (class)">Request</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of Request</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


139
140
141
142
143
144
145
146
147
148
149</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 139</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span> <span class='id identifier rubyid_sock'>sock</span> <span class='rparen'>)</span>
  <span class='ivar'>@version</span>    <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Client.html#REQUEST_VERSION-constant" title="Rex::Proto::Proxy::Socks5::Client::REQUEST_VERSION (constant)">REQUEST_VERSION</a></span></span>
  <span class='ivar'>@command</span>    <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@atyp</span>       <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@dest_port</span>  <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@dest_ip</span>    <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@sock</span>       <span class='op'>=</span> <span class='id identifier rubyid_sock'>sock</span>
  <span class='ivar'>@username</span>   <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@password</span>   <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@serverAuthMethods</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='int'>0x00</span> <span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="atyp-instance_method">
  
    #<strong>atyp</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute atyp</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


300
301
302</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 300</span>

<span class='kw'>def</span> <span class='id identifier rubyid_atyp'>atyp</span>
  <span class='ivar'>@atyp</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="command-instance_method">
  
    #<strong>command</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute command</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


300
301
302</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 300</span>

<span class='kw'>def</span> <span class='id identifier rubyid_command'>command</span>
  <span class='ivar'>@command</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="dest_ip-instance_method">
  
    #<strong>dest_ip</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute dest_ip</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


300
301
302</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 300</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dest_ip'>dest_ip</span>
  <span class='ivar'>@dest_ip</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="dest_port-instance_method">
  
    #<strong>dest_port</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute dest_port</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


300
301
302</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 300</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dest_port'>dest_port</span>
  <span class='ivar'>@dest_port</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="hostname-instance_method">
  
    #<strong>hostname</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute hostname</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


300
301
302</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 300</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hostname'>hostname</span>
  <span class='ivar'>@hostname</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="version-instance_method">
  
    #<strong>version</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute version</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


300
301
302</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 300</span>

<span class='kw'>def</span> <span class='id identifier rubyid_version'>version</span>
  <span class='ivar'>@version</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="is_bind?-instance_method">
  
    #<strong>is_bind?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


296
297
298</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 296</span>

<span class='kw'>def</span> <span class='id identifier rubyid_is_bind?'>is_bind?</span>
  <span class='ivar'>@command</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Client.html#REQUEST_COMMAND_BIND-constant" title="Rex::Proto::Proxy::Socks5::Client::REQUEST_COMMAND_BIND (constant)">REQUEST_COMMAND_BIND</a></span></span> <span class='op'>?</span> <span class='kw'>true</span> <span class='op'>:</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="is_connect?-instance_method">
  
    #<strong>is_connect?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


292
293
294</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 292</span>

<span class='kw'>def</span> <span class='id identifier rubyid_is_connect?'>is_connect?</span>
  <span class='ivar'>@command</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Client.html#REQUEST_COMMAND_CONNECT-constant" title="Rex::Proto::Proxy::Socks5::Client::REQUEST_COMMAND_CONNECT (constant)">REQUEST_COMMAND_CONNECT</a></span></span> <span class='op'>?</span> <span class='kw'>true</span> <span class='op'>:</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parseIncomingConnectionRequest-instance_method">
  
    #<strong>parseIncomingConnectionRequest</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 225</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parseIncomingConnectionRequest'>parseIncomingConnectionRequest</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='ivar'>@sock</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='lparen'>(</span> <span class='int'>262</span> <span class='rparen'>)</span>  <span class='comment'># MAX LENGTH OF REQUEST WITH 256 BYTE HOSTNAME
</span>
  <span class='comment'># fail if the incoming request is less than 8 bytes (malformed)
</span>  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Client closed connection while expecting SOCKS connection request</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span><span class='lparen'>(</span> <span class='id identifier rubyid_raw'>raw</span> <span class='op'>==</span> <span class='kw'>nil</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Client sent malformed packet expecting SOCKS connection request</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span><span class='lparen'>(</span> <span class='id identifier rubyid_raw'>raw</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&lt;</span> <span class='int'>8</span> <span class='rparen'>)</span>

  <span class='comment'># Per RFC1928, the lengths of the SOCKS5 request header are:
</span>  <span class='comment'># +----+-----+-------+------+----------+----------+
</span>  <span class='comment'># |VER | CMD |  RSV  | ATYP | DST.ADDR | DST.PORT |
</span>  <span class='comment'># +----+-----+-------+------+----------+----------+
</span>  <span class='comment'># | 1  |  1  | X&#39;00&#39; |  1   | Variable |    2     |
</span>  <span class='comment'># +----+-----+-------+------+----------+----------+
</span>
  <span class='ivar'>@version</span>   <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='comment'># fail if the incoming request is an unsupported version (not &#39;0x05&#39;)
</span>  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid SOCKS version received from client</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span><span class='lparen'>(</span> <span class='ivar'>@version</span> <span class='op'>!=</span> <span class='const'><span class='object_link'><a href="../Client.html#REQUEST_VERSION-constant" title="Rex::Proto::Proxy::Socks5::Client::REQUEST_VERSION (constant)">REQUEST_VERSION</a></span></span> <span class='rparen'>)</span>

  <span class='ivar'>@command</span>   <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='int'>1</span><span class='op'>..</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='comment'># fail if the incoming request is an unsupported command (currently only CONNECT)
</span>  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid SOCKS proxy command received from client</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='lparen'>(</span> <span class='ivar'>@command</span> <span class='op'>!=</span> <span class='const'><span class='object_link'><a href="../Client.html#REQUEST_COMMAND_CONNECT-constant" title="Rex::Proto::Proxy::Socks5::Client::REQUEST_COMMAND_CONNECT (constant)">REQUEST_COMMAND_CONNECT</a></span></span> <span class='rparen'>)</span>

  <span class='comment'># &quot;address type of following address&quot;
</span>  <span class='ivar'>@atyp</span>      <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='int'>3</span><span class='op'>..</span><span class='int'>3</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='ivar'>@atyp</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Client.html#ADDRESS_TYPE_IPV4-constant" title="Rex::Proto::Proxy::Socks5::Client::ADDRESS_TYPE_IPV4 (constant)">ADDRESS_TYPE_IPV4</a></span></span><span class='rparen'>)</span>
    <span class='comment'># &quot;the address is a version-4 IP address, with a length of 4 octets&quot;
</span>    <span class='id identifier rubyid_addressLen'>addressLen</span> <span class='op'>=</span> <span class='int'>4</span>
    <span class='id identifier rubyid_addressEnd'>addressEnd</span> <span class='op'>=</span> <span class='int'>3</span> <span class='op'>+</span> <span class='id identifier rubyid_addressLen'>addressLen</span>

    <span class='id identifier rubyid_hostname'>hostname</span>   <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@dest_ip</span>  <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_itoa'>addr_itoa</span><span class='lparen'>(</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='int'>4</span><span class='op'>..</span><span class='int'>7</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='ivar'>@atyp</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Client.html#ADDRESS_TYPE_IPV6-constant" title="Rex::Proto::Proxy::Socks5::Client::ADDRESS_TYPE_IPV6 (constant)">ADDRESS_TYPE_IPV6</a></span></span><span class='rparen'>)</span>
    <span class='comment'># &quot;the address is a version-6 IP address, with a length of 16 octets&quot;
</span>    <span class='id identifier rubyid_addressLen'>addressLen</span> <span class='op'>=</span> <span class='int'>16</span>
    <span class='id identifier rubyid_addressEnd'>addressEnd</span> <span class='op'>=</span> <span class='int'>3</span> <span class='op'>+</span> <span class='id identifier rubyid_addressLen'>addressLen</span>

    <span class='id identifier rubyid_hostname'>hostname</span>   <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@dest_ip</span>  <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='int'>4</span><span class='op'>..</span><span class='int'>19</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>H4H4H4H4H4H4H4H4</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'><span class='object_link'><a href="../../../../../top-level-namespace.html#join-instance_method" title="#join (method)">join</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>  <span class='comment'># Workaround because Rex::Socket.addr_itoa hurts too much
</span>  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='ivar'>@atyp</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Client.html#ADDRESS_TYPE_DOMAINNAME-constant" title="Rex::Proto::Proxy::Socks5::Client::ADDRESS_TYPE_DOMAINNAME (constant)">ADDRESS_TYPE_DOMAINNAME</a></span></span><span class='rparen'>)</span>
    <span class='comment'># &quot;the address field contains a fully-qualified domain name.  The first
</span>    <span class='comment'># octet of the address field contains the number of octets of name that
</span>    <span class='comment'># follow, there is no terminating NUL octet.&quot;
</span>
    <span class='id identifier rubyid_addressLen'>addressLen</span>   <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='int'>4</span><span class='op'>..</span><span class='int'>4</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_addressStart'>addressStart</span> <span class='op'>=</span> <span class='int'>5</span>
    <span class='id identifier rubyid_addressEnd'>addressEnd</span>   <span class='op'>=</span> <span class='int'>4</span><span class='op'>+</span><span class='id identifier rubyid_addressLen'>addressLen</span>

    <span class='ivar'>@hostname</span>    <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='id identifier rubyid_addressStart'>addressStart</span><span class='op'>..</span><span class='id identifier rubyid_addressEnd'>addressEnd</span><span class='rbracket'>]</span>

    <span class='ivar'>@dest_ip</span>    <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_resolve'>resolve</span><span class='lparen'>(</span> <span class='ivar'>@hostname</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_ilog'><span class='object_link'><a href="../../../../../top-level-namespace.html#ilog-instance_method" title="#ilog (method)">ilog</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SOCKS5: Resolved &#39;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@hostname</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; to </span><span class='embexpr_beg'>#{</span><span class='ivar'>@dest_ip</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='comment'># fail if we couldnt resolve the hostname
</span>    <span class='kw'>if</span><span class='lparen'>(</span> <span class='kw'>not</span> <span class='ivar'>@dest_ip</span> <span class='rparen'>)</span>
      <span class='id identifier rubyid_wlog'><span class='object_link'><a href="../../../../../top-level-namespace.html#wlog-instance_method" title="#wlog (method)">wlog</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SOCKS5: Failed to resolve &#39;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@hostname</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;...</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Invalid address type requested in connection request</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@dest_port</span> <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='id identifier rubyid_addressEnd'>addressEnd</span><span class='op'>+</span><span class='int'>1</span> <span class='op'>..</span> <span class='id identifier rubyid_addressEnd'>addressEnd</span><span class='op'>+</span><span class='int'>3</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

  <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parseIncomingCredentials-instance_method">
  
    #<strong>parseIncomingCredentials</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 188</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parseIncomingCredentials'>parseIncomingCredentials</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='comment'># Based on RFC1929: https://tools.ietf.org/html/rfc1929
</span>  <span class='comment'>#   +----+------+----------+------+----------+
</span>  <span class='comment'>#   |VER | ULEN |  UNAME   | PLEN |  PASSWD  |
</span>  <span class='comment'>#   +----+------+----------+------+----------+
</span>  <span class='comment'>#   | 1  |  1   | 1 to 255 |  1   | 1 to 255 |  VERSION: 0x01
</span>  <span class='comment'>#   +----+------+----------+------+----------+
</span>
  <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='ivar'>@sock</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span> <span class='int'>1</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid SOCKS5 authentication packet received.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='kw'>not</span>
    <span class='lparen'>(</span> <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='op'>==</span> <span class='int'>0x01</span> <span class='rparen'>)</span>

  <span class='id identifier rubyid_usernameLength'>usernameLength</span> <span class='op'>=</span> <span class='ivar'>@sock</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span> <span class='int'>1</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='id identifier rubyid_username'>username</span>       <span class='op'>=</span> <span class='ivar'>@sock</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span> <span class='id identifier rubyid_usernameLength'>usernameLength</span> <span class='rparen'>)</span>

  <span class='id identifier rubyid_passwordLength'>passwordLength</span> <span class='op'>=</span> <span class='ivar'>@sock</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span> <span class='int'>1</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='id identifier rubyid_password'>password</span>       <span class='op'>=</span> <span class='ivar'>@sock</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span> <span class='id identifier rubyid_passwordLength'>passwordLength</span> <span class='rparen'>)</span>

  <span class='comment'>#   +----+--------+
</span>  <span class='comment'>#   |VER | STATUS |
</span>  <span class='comment'>#   +----+--------+  VERSION: 0x01
</span>  <span class='comment'>#   | 1  |   1    |  STATUS:  0x00=SUCCESS, otherwise FAILURE
</span>  <span class='comment'>#   +----+--------+
</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_username'>username</span> <span class='op'>==</span> <span class='ivar'>@username</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_password'>password</span> <span class='op'>==</span> <span class='ivar'>@password</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='const'><span class='object_link'><a href="../Client.html#AUTH_PROTOCOL_VERSION-constant" title="Rex::Proto::Proxy::Socks5::Client::AUTH_PROTOCOL_VERSION (constant)">AUTH_PROTOCOL_VERSION</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Client.html#AUTH_SUCCESS-constant" title="Rex::Proto::Proxy::Socks5::Client::AUTH_SUCCESS (constant)">AUTH_SUCCESS</a></span></span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span> <span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CC</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_ilog'><span class='object_link'><a href="../../../../../top-level-namespace.html#ilog-instance_method" title="#ilog (method)">ilog</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SOCKS5: Successfully authenticated</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='ivar'>@sock</span><span class='period'>.</span><span class='id identifier rubyid_put'>put</span><span class='lparen'>(</span> <span class='id identifier rubyid_raw'>raw</span> <span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
  <span class='kw'>else</span> 
    <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='const'><span class='object_link'><a href="../Client.html#AUTH_PROTOCOL_VERSION-constant" title="Rex::Proto::Proxy::Socks5::Client::AUTH_PROTOCOL_VERSION (constant)">AUTH_PROTOCOL_VERSION</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Client.html#AUTH_FAILURE-constant" title="Rex::Proto::Proxy::Socks5::Client::AUTH_FAILURE (constant)">AUTH_FAILURE</a></span></span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span> <span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CC</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span>
    <span class='ivar'>@sock</span><span class='period'>.</span><span class='id identifier rubyid_put'>put</span><span class='lparen'>(</span> <span class='id identifier rubyid_raw'>raw</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid SOCKS5 credentials provided</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parseIncomingSession-instance_method">
  
    #<strong>parseIncomingSession</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The first packet sent by the client is a session request
<code>----</code>———-<code>----------</code> |VER | NMETHODS | METHODS  |
<code>----</code>———-<code>----------</code> | 1  |    1     | 1 to 255 |  
METHOD (x00) = NO AUTHENTICATION REQUIRED
<code>----</code>———-<code>----------</code></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 163</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parseIncomingSession'>parseIncomingSession</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='ivar'>@sock</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span> <span class='int'>1</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid Socks5 request packet received.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='kw'>not</span>
    <span class='lparen'>(</span> <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Client.html#REQUEST_VERSION-constant" title="Rex::Proto::Proxy::Socks5::Client::REQUEST_VERSION (constant)">REQUEST_VERSION</a></span></span> <span class='rparen'>)</span>

  <span class='id identifier rubyid_nMethods'>nMethods</span> <span class='op'>=</span> <span class='ivar'>@sock</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span> <span class='int'>1</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

  <span class='id identifier rubyid_unpackFormatStr'>unpackFormatStr</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_nMethods'>nMethods</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>                                     <span class='comment'># IS THIS REALLY WHAT I&#39;M DOING?!
</span>  <span class='id identifier rubyid_clientAuthMethods'>clientAuthMethods</span> <span class='op'>=</span> <span class='ivar'>@sock</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span> <span class='id identifier rubyid_nMethods'>nMethods</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span> <span class='id identifier rubyid_unpackFormatStr'>unpackFormatStr</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_authMethods'>authMethods</span> <span class='op'>=</span> <span class='lparen'>(</span> <span class='id identifier rubyid_clientAuthMethods'>clientAuthMethods</span> <span class='op'>&amp;</span> <span class='ivar'>@serverAuthMethods</span> <span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='lparen'>(</span> <span class='id identifier rubyid_authMethods'>authMethods</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='const'><span class='object_link'><a href="../Client.html#REQUEST_VERSION-constant" title="Rex::Proto::Proxy::Socks5::Client::REQUEST_VERSION (constant)">REQUEST_VERSION</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Client.html#AUTH_METHODS_REJECTED-constant" title="Rex::Proto::Proxy::Socks5::Client::AUTH_METHODS_REJECTED (constant)">AUTH_METHODS_REJECTED</a></span></span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span> <span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CC</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span>
    <span class='ivar'>@sock</span><span class='period'>.</span><span class='id identifier rubyid_put'>put</span><span class='lparen'>(</span> <span class='id identifier rubyid_raw'>raw</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No matching authentication methods agreed upon in session request</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="../Client.html#REQUEST_VERSION-constant" title="Rex::Proto::Proxy::Socks5::Client::REQUEST_VERSION (constant)">REQUEST_VERSION</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_authMethods'>authMethods</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span> <span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CC</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span>
    <span class='ivar'>@sock</span><span class='period'>.</span><span class='id identifier rubyid_put'>put</span><span class='lparen'>(</span> <span class='id identifier rubyid_raw'>raw</span> <span class='rparen'>)</span>

    <span class='id identifier rubyid_parseIncomingCredentials'>parseIncomingCredentials</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_authMethods'>authMethods</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Client.html#AUTH_METHOD_TYPE_USER_PASS-constant" title="Rex::Proto::Proxy::Socks5::Client::AUTH_METHOD_TYPE_USER_PASS (constant)">AUTH_METHOD_TYPE_USER_PASS</a></span></span> 
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="requireAuthentication-instance_method">
  
    #<strong>requireAuthentication</strong>(username, password)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


151
152
153
154
155</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 151</span>

<span class='kw'>def</span> <span class='id identifier rubyid_requireAuthentication'>requireAuthentication</span><span class='lparen'>(</span> <span class='id identifier rubyid_username'>username</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span> <span class='rparen'>)</span>
  <span class='ivar'>@username</span> <span class='op'>=</span> <span class='id identifier rubyid_username'>username</span>
  <span class='ivar'>@password</span> <span class='op'>=</span> <span class='id identifier rubyid_password'>password</span>
  <span class='ivar'>@serverAuthMethods</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='const'><span class='object_link'><a href="../Client.html#AUTH_METHOD_TYPE_USER_PASS-constant" title="Rex::Proto::Proxy::Socks5::Client::AUTH_METHOD_TYPE_USER_PASS (constant)">AUTH_METHOD_TYPE_USER_PASS</a></span></span> <span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="resolve-instance_method">
  
    #<strong>resolve</strong>(hostname)  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Resolve the given hostname into a dotted IP address.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


305
306
307
308
309
310
311
312
313
314</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/proxy/socks5.rb', line 305</span>

<span class='kw'>def</span> <span class='id identifier rubyid_resolve'>resolve</span><span class='lparen'>(</span> <span class='id identifier rubyid_hostname'>hostname</span> <span class='rparen'>)</span>
  <span class='kw'>if</span><span class='lparen'>(</span> <span class='kw'>not</span> <span class='id identifier rubyid_hostname'>hostname</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='rparen'>)</span>
    <span class='kw'>begin</span>
      <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="../../../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_itoa'>addr_itoa</span><span class='lparen'>(</span> <span class='const'><span class='object_link'><a href="../../../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_gethostbyname'>gethostbyname</span><span class='lparen'>(</span> <span class='id identifier rubyid_hostname'>hostname</span> <span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'>SocketError</span>
      <span class='kw'>return</span> <span class='kw'>nil</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue May 29 22:39:22 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.12 (ruby-2.3.3).
</div>

    </div>
  </body>
</html>